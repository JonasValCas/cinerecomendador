<% /* No incluir header, ya lo maneja express-ejs-layouts */ %>

<!-- Establecer el título de la página -->
<% title = 'Administrar Usuarios' %>

<h1 class="mb-4">Administrar Usuarios</h1>

<div class="card">
  <div class="card-header bg-primary text-white">
    <h5 class="mb-0">Lista de Usuarios</h5>
  </div>
  <div class="card-body">
    <% if (users.length === 0) { %>
      <div class="alert alert-info">No hay usuarios registrados.</div>
    <% } else { %>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Usuario</th>
              <th>Email</th>
              <th>Rol</th>
              <th>Fecha de Registro</th>
              <th>Calificaciones</th>
            </tr>
          </thead>
          <tbody>
            <% users.forEach(user => { %>
              <tr>
                <td><%= user.username %></td>
                <td><%= user.email %></td>
                <td>
                  <span class="badge <%= user.isAdmin ? 'bg-danger' : 'bg-success' %>">
                    <%= user.isAdmin ? 'Administrador' : 'Usuario' %>
                  </span>
                </td>
                <td><%= new Date(user.createdAt).toLocaleDateString() %></td>
                <td>
                  <span class="badge bg-primary rounded-pill">
                    <%= userRatingCounts[user._id] || 0 %>
                  </span>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    <% } %>
  </div>
</div>

<% /* No incluir footer, ya lo maneja express-ejs-layouts */ %>
